{% extends 'index.html' %}
{% load widget_tweaks %}
{% load static %}

{% block title %}
Listado de cuentas corrientes de clientes 
{% endblock title %}

{% block content %}

<div class="bg-gray-100" id="report">
    <div class="card">
        <div class="card-header">
            <strong class="card-title">Cuentas corrientes de clientes</strong>
        </div>
    </div>
    <div class="table-stats order-table ov-h">
        <table class="table">
            <thead>
                <tr>
                    <th>N° Cta corriente</th>
                    <th>Responsable</th>
                    <th>Medio de pago</th>
                    <th>Fecha</th>
                    <th>Moneda</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {% if ventas %}
                {% for venta in ventas %}
                <tr>
                    <td>{{ venta.cuenta_corriente }}</td>
                    <td>{{ venta.cliente_asociado}}</td>
                    <td>{{ venta.medio_de_pago }}</td>
                    <td>{{ venta.fecha }}</td>
                    <td>{{ venta.tipo_de_moneda }}</td>>
                    {% if venta.tipo_de_moneda.opciones == 'DOLAR' %}
                    <td>${{ venta.total_dolar}}</td>
                    {% elif venta.tipo_de_moneda.opciones == 'EURO' %} 
                    <td>€{{ venta.total_euro}}</td>
                    {% else %}
                    <td>${{ venta.total_peso}}</td> 
                    {% endif %}
                </tr>
                {% endfor %}
                {% else %}
                <h5>No hay ventas registradas :(</h1>
                    {% endif %}
            </tbody>
        </table>
        <div id="chartdiv"></div>

    </div>

</div>

</div>

<!--Inserta Grafico-->
<!-- <button hidden name="button" class="fa fa-print" id="button" onclick="printChart('report')"> Imprimir</button>

<style>
    #chartdiv {
        height: 350px;
        width: 69%;
        margin: auto;
    }
</style>

<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
<script>
    data = [];

    function printChart(divName) {
        let toPrint = document.getElementById(divName).innerHTML;
        let originalContents = document.body.innerHTML;

        document.body.innerHTML = toPrint;
        window.print();
        document.body.innerHTML = originalContents;
    }

    window.onload = (event) => {
        let elements = document.getElementsByClassName("moneda");
        cont = 0;

        for (i = 0; i < elements.length; i++) {
            let element = elements[cont];
            let moneda = document.getElementById(element.id).innerText;
            let cantidad = document.getElementById(element.id + "cantidad").innerText;
            let info = { "moneda": moneda, "cantidad": cantidad };

            data.push(info);
            cont++;
        }

        am4core.ready(function () {
            // Themes begin
            am4core.useTheme(am4themes_animated);
            // Themes end

            // Create chart instance
            let chart = am4core.create("chartdiv", am4charts.PieChart);

            // Add data
            chart.data = data;

            // Add and configure Series
            let pieSeries = chart.series.push(new am4charts.PieSeries());
            pieSeries.dataFields.value = "cantidad";
            pieSeries.dataFields.category = "moneda";
            pieSeries.slices.template.stroke = am4core.color("#fff");
            pieSeries.slices.template.strokeWidth = 2;
            pieSeries.slices.template.strokeOpacity = 1;

            // This creates initial animation
            pieSeries.hiddenState.properties.opacity = 1;
            pieSeries.hiddenState.properties.endAngle = -90;
            pieSeries.hiddenState.properties.startAngle = -90;
        });

        setTimeout(function () {
            document.getElementById("button").hidden = false;
        }, 1000);
    };
</script> -->






{% endblock %}